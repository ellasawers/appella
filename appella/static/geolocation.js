//funcion autoejecutable para obtener las coordenadas con HTML Geolocation API
//y tambien dibujar un mapa utilizando el API de Google Maps
(function(){
	//capa que va a contener el mapa (esta definida en el documento HTML)
	var divMapa=document.getElementById('divMapa');
	//capa para mostrar las coordenadas (definida tambien en el HTML)
	var divCoordenadas=document.getElementById('divCoordenadas');
	
	//verificamos si el navegador soporta Geolocation API de HTML5
	if(navigator.geolocation){
		//intentamos obtener las coordenadas del usuario
		navigator.geolocation.getCurrentPosition(function(objPosicion){
			//almacenamos en variables la longitud y latitud
			var arg=[//-17.280216551959015, -66.43812312109372, -17.280216551959015, -65.88346355078124, -17.84582099396257, -66.43812312109372,
-17.285820994, -66.4381231211, -17.285820994, -66.4341231211, -17.281820994, -66.4381231211, -17.281820994, -66.4341231211,
-17.285820994, -66.4301231211, -17.285820994, -66.4261231211, -17.281820994, -66.4301231211, -17.281820994, -66.4261231211,
-17.285820994, -66.4221231211, -17.285820994, -66.4181231211, -17.281820994, -66.4221231211, -17.281820994, -66.4181231211,
-17.285820994, -66.4141231211, -17.285820994, -66.4101231211, -17.281820994, -66.4141231211, -17.281820994, -66.4101231211,
-17.285820994, -66.4061231211, -17.285820994, -66.4021231211, -17.281820994, -66.4061231211, -17.281820994, -66.4021231211,
-17.285820994, -66.3981231211, -17.285820994, -66.3941231211, -17.281820994, -66.3981231211, -17.281820994, -66.3941231211,
-17.285820994, -66.3901231211, -17.285820994, -66.3861231211, -17.281820994, -66.3901231211, -17.281820994, -66.3861231211,
-17.285820994, -66.3821231211, -17.285820994, -66.3781231211, -17.281820994, -66.3821231211, -17.281820994, -66.3781231211,
-17.285820994, -66.3741231211, -17.285820994, -66.3701231211, -17.281820994, -66.3741231211, -17.281820994, -66.3701231211,
-17.285820994, -66.3661231211, -17.285820994, -66.3621231211, -17.281820994, -66.3661231211, -17.281820994, -66.3621231211,
-17.285820994, -66.3581231211, -17.285820994, -66.3541231211, -17.281820994, -66.3581231211, -17.281820994, -66.3541231211,
-17.285820994, -66.3501231211, -17.285820994, -66.3461231211, -17.281820994, -66.3501231211, -17.281820994, -66.3461231211,
-17.285820994, -66.3421231211, -17.285820994, -66.3381231211, -17.281820994, -66.3421231211, -17.281820994, -66.3381231211,
-17.285820994, -66.3341231211, -17.285820994, -66.3301231211, -17.281820994, -66.3341231211, -17.281820994, -66.3301231211,
-17.285820994, -66.3261231211, -17.285820994, -66.3221231211, -17.281820994, -66.3261231211, -17.281820994, -66.3221231211,
-17.285820994, -66.3181231211, -17.285820994, -66.3141231211, -17.281820994, -66.3181231211, -17.281820994, -66.3141231211,
-17.285820994, -66.3101231211, -17.285820994, -66.3061231211, -17.281820994, -66.3101231211, -17.281820994, -66.3061231211,
-17.285820994, -66.3021231211, -17.285820994, -66.2981231211, -17.281820994, -66.3021231211, -17.281820994, -66.2981231211,
-17.285820994, -66.2941231211, -17.285820994, -66.2901231211, -17.281820994, -66.2941231211, -17.281820994, -66.2901231211,
-17.285820994, -66.2861231211, -17.285820994, -66.2821231211, -17.281820994, -66.2861231211, -17.281820994, -66.2821231211,
-17.285820994, -66.2781231211, -17.285820994, -66.2741231211, -17.281820994, -66.2781231211, -17.281820994, -66.2741231211,
-17.285820994, -66.2701231211, -17.285820994, -66.2661231211, -17.281820994, -66.2701231211, -17.281820994, -66.2661231211,
-17.285820994, -66.2621231211, -17.285820994, -66.2581231211, -17.281820994, -66.2621231211, -17.281820994, -66.2581231211,
-17.285820994, -66.2541231211, -17.285820994, -66.2501231211, -17.281820994, -66.2541231211, -17.281820994, -66.2501231211,
-17.285820994, -66.2461231211, -17.285820994, -66.2421231211, -17.281820994, -66.2461231211, -17.281820994, -66.2421231211,
-17.285820994, -66.2381231211, -17.285820994, -66.2341231211, -17.281820994, -66.2381231211, -17.281820994, -66.2341231211,
-17.285820994, -66.2301231211, -17.285820994, -66.2261231211, -17.281820994, -66.2301231211, -17.281820994, -66.2261231211,
-17.285820994, -66.2221231211, -17.285820994, -66.2181231211, -17.281820994, -66.2221231211, -17.281820994, -66.2181231211,
-17.285820994, -66.2141231211, -17.285820994, -66.2101231211, -17.281820994, -66.2141231211, -17.281820994, -66.2101231211,
-17.285820994, -66.2061231211, -17.285820994, -66.2021231211, -17.281820994, -66.2061231211, -17.281820994, -66.2021231211,
-17.285820994, -66.1981231211, -17.285820994, -66.1941231211, -17.281820994, -66.1981231211, -17.281820994, -66.1941231211,
-17.285820994, -66.1901231211, -17.285820994, -66.1861231211, -17.281820994, -66.1901231211, -17.281820994, -66.1861231211,
-17.285820994, -66.1821231211, -17.285820994, -66.1781231211, -17.281820994, -66.1821231211, -17.281820994, -66.1781231211,
-17.285820994, -66.1741231211, -17.285820994, -66.1701231211, -17.281820994, -66.1741231211, -17.281820994, -66.1701231211,
-17.285820994, -66.1661231211, -17.285820994, -66.1621231211, -17.281820994, -66.1661231211, -17.281820994, -66.1621231211,
-17.285820994, -66.1581231211, -17.285820994, -66.1541231211, -17.281820994, -66.1581231211, -17.281820994, -66.1541231211,
-17.285820994, -66.1501231211, -17.285820994, -66.1461231211, -17.281820994, -66.1501231211, -17.281820994, -66.1461231211,
-17.285820994, -66.1421231211, -17.285820994, -66.1381231211, -17.281820994, -66.1421231211, -17.281820994, -66.1381231211,
-17.285820994, -66.1341231211, -17.285820994, -66.1301231211, -17.281820994, -66.1341231211, -17.281820994, -66.1301231211,
-17.285820994, -66.1261231211, -17.285820994, -66.1221231211, -17.281820994, -66.1261231211, -17.281820994, -66.1221231211,
-17.285820994, -66.1181231211, -17.285820994, -66.1141231211, -17.281820994, -66.1181231211, -17.281820994, -66.1141231211,
-17.285820994, -66.1101231211, -17.285820994, -66.1061231211, -17.281820994, -66.1101231211, -17.281820994, -66.1061231211,
-17.285820994, -66.1021231211, -17.285820994, -66.0981231211, -17.281820994, -66.1021231211, -17.281820994, -66.0981231211,
-17.285820994, -66.0941231211, -17.285820994, -66.0901231211, -17.281820994, -66.0941231211, -17.281820994, -66.0901231211,
-17.285820994, -66.0861231211, -17.285820994, -66.0821231211, -17.281820994, -66.0861231211, -17.281820994, -66.0821231211,
-17.285820994, -66.0781231211, -17.285820994, -66.0741231211, -17.281820994, -66.0781231211, -17.281820994, -66.0741231211,
-17.285820994, -66.0701231211, -17.285820994, -66.0661231211, -17.281820994, -66.0701231211, -17.281820994, -66.0661231211,
-17.285820994, -66.0621231211, -17.285820994, -66.0581231211, -17.281820994, -66.0621231211, -17.281820994, -66.0581231211,
-17.285820994, -66.0541231211, -17.285820994, -66.0501231211, -17.281820994, -66.0541231211, -17.281820994, -66.0501231211,
-17.285820994, -66.0461231211, -17.285820994, -66.0421231211, -17.281820994, -66.0461231211, -17.281820994, -66.0421231211,
-17.285820994, -66.0381231211, -17.285820994, -66.0341231211, -17.281820994, -66.0381231211, -17.281820994, -66.0341231211,
-17.285820994, -66.0301231211, -17.285820994, -66.0261231211, -17.281820994, -66.0301231211, -17.281820994, -66.0261231211,
-17.285820994, -66.0221231211, -17.285820994, -66.0181231211, -17.281820994, -66.0221231211, -17.281820994, -66.0181231211,
-17.285820994, -66.0141231211, -17.285820994, -66.0101231211, -17.281820994, -66.0141231211, -17.281820994, -66.0101231211,
-17.285820994, -66.0061231211, -17.285820994, -66.0021231211, -17.281820994, -66.0061231211, -17.281820994, -66.0021231211,
-17.285820994, -65.9981231211, -17.285820994, -65.9941231211, -17.281820994, -65.9981231211, -17.281820994, -65.9941231211,
-17.285820994, -65.9901231211, -17.285820994, -65.9861231211, -17.281820994, -65.9901231211, -17.281820994, -65.9861231211,
-17.285820994, -65.9821231211, -17.285820994, -65.9781231211, -17.281820994, -65.9821231211, -17.281820994, -65.9781231211,
-17.285820994, -65.9741231211, -17.285820994, -65.9701231211, -17.281820994, -65.9741231211, -17.281820994, -65.9701231211,
-17.285820994, -65.9661231211, -17.285820994, -65.9621231211, -17.281820994, -65.9661231211, -17.281820994, -65.9621231211,
-17.285820994, -65.9581231211, -17.285820994, -65.9541231211, -17.281820994, -65.9581231211, -17.281820994, -65.9541231211,
-17.285820994, -65.9501231211, -17.285820994, -65.9461231211, -17.281820994, -65.9501231211, -17.281820994, -65.9461231211,
-17.285820994, -65.9421231211, -17.285820994, -65.9381231211, -17.281820994, -65.9421231211, -17.281820994, -65.9381231211,
-17.285820994, -65.9341231211, -17.285820994, -65.9301231211, -17.281820994, -65.9341231211, -17.281820994, -65.9301231211,
-17.285820994, -65.9261231211, -17.285820994, -65.9221231211, -17.281820994, -65.9261231211, -17.281820994, -65.9221231211,
-17.285820994, -65.9181231211, -17.285820994, -65.9141231211, -17.281820994, -65.9181231211, -17.281820994, -65.9141231211,
-17.285820994, -65.9101231211, -17.285820994, -65.9061231211, -17.281820994, -65.9101231211, -17.281820994, -65.9061231211,
-17.285820994, -65.9021231211, -17.285820994, -65.8981231211, -17.281820994, -65.9021231211, -17.281820994, -65.8981231211,
-17.285820994, -65.8941231211, -17.285820994, -65.8901231211, -17.281820994, -65.8941231211, -17.281820994, -65.8901231211,
-17.285820994, -65.8861231211, -17.285820994, -65.8821231211, -17.281820994, -65.8861231211, -17.281820994, -65.8821231211

]
			//mostramos en pantalla (solo texto) las coordenadas obtenidas
			texto='';
			var objOpciones={
				mapTypeId:google.maps.MapTypeId.HYBRID,
				zoom:12,
				mapTypeControl:true,
				center:new google.maps.LatLng(-17.563018772960792,-66.71545290624996)
			};
			var objMapa=new google.maps.Map(divMapa,objOpciones);
			for (var i = 0; i <= arg.length - 1; i=i+2){
				lat = arg[i];
				lon = arg[i+1];
				texto='<br>Lat'+i+': '+lat+' - Lon'+(i+1)+': '+lon;
				//agregamos un marcador al mapa con nuestra ubicacion
				new google.maps.Marker({
					title:'punto'+(i/2)+' '+lat+' '+lon,
					draggable: true,
					position:new google.maps.LatLng(lat,lon),
					map:objMapa
				});
			};
			divCoordenadas.innerHTML=texto;
		},function(objError){
			//manejamos los errores devueltos por Geolocation API
			switch(objError.code){
				//no se pudo obtener la informacion de la ubicacion
				case objError.POSITION_UNAVAILABLE:
					divMapa.innerHTML='La informaciÃ³n de su posiciÃ³n no estÃ¡ disponible.';
				break;
				//timeout al intentar obtener las coordenadas
				case objError.TIMEOUT:
					divMapa.innerHTML='Tiempo de espera agotado.';
				break;
				//el usuario no desea mostrar la ubicacion
				case objError.PERMISSION_DENIED:
					divMapa.innerHTML='Acceso denegado.';
				break;
				//errores desconocidos
				case objError.UNKNOWN_ERROR:
					divMapa.innerHTML='Error desconocido.';
				break;
			}
		});
	}else{
		//el navegador del usuario no soporta el API de Geolocalizacion de HTML5
		divCoordenadas.innerHTML='Su navegador no soporta Geolocation API de HTML5';
	}
})();



